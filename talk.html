<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <script src="https://cdn.jsdelivr.net/npm/jquery@3.5.1/dist/jquery.slim.min.js" integrity="sha384-DfXdz2htPH0lsSSs5nCTpuj/zy4C+OGpamoFVy38MVBnE+IbbVYUew+OrCXaRkfj" crossorigin="anonymous"></script>
    <script src="https://cdn.jsdelivr.net/npm/bootstrap@4.6.2/dist/js/bootstrap.bundle.min.js" integrity="sha384-Fy6S3B9q64WdZWQUiU+q4/2Lc9npb8tCaSX9FK7E8HnRr0Jz8D6OP9dO5Vg3Q9ct" crossorigin="anonymous"></script>

    <title>Family History</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #fdf6e3;
            margin: 0;
            padding: 0;
        }
        header {
            background-color: #6c4f3d;
            color: #ffffff;
            padding: 20px;
            text-align: center;
        }
        nav {
            background-color: #8b5e3c;
            padding: 10px;
            display: flex;
            justify-content: center;
            gap: 20px;
        }
        nav a {
            color: #ffffff;
            text-decoration: none;
            font-weight: bold;
        }
        nav a:hover {
            text-decoration: underline;
        }
        .container {
            max-width: 600px;
            margin: 50px auto;
            background: #fff;
            border-radius: 10px;
            box-shadow: 0 2px 5px rgba(0, 0, 0, 0.1);
            padding: 20px;
        }
        
        .input-area {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
            position: relative; 
        }
        .input-area img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }
        .input-area textarea {
            flex: 1;
            height: 50px; 
            padding: 10px 50px 10px 10px; 
            border: 1px solid #ccc;
            border-radius: 10px;
            resize: none; 
            font-size: 14px;

        }
        .input-area textarea:focus {
            outline: none; 
        }
        .input-area button {
            position: absolute; 
            right: 10px; 
            background: none;
            border: none;
            color: #6c4f3d;
            font-size: 20px;
            cursor: pointer;
        }
        .input-area button:hover {
            color: #8b5e3c;
        }
        .message {
            display: flex;
            align-items: flex-start;
            gap: 10px;
            margin-bottom: 20px;
            padding: 10px;
            border: 1px solid #eee;
            border-radius: 10px;
            background: #f9f9f9;
        }
        .message img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }
        .message-content {
            flex: 1;
        }
        .message-content h4 {
            margin: 0;
            font-size: 16px;
            font-weight: bold;
        }
        .message-content p {
            margin: 5px 0 0;
            font-size: 14px;
        }
        .timestamp {
            font-size: 12px;
            color: #666;
            margin-top: 5px;
        }
        .delete-btn {
            background: none;
            border: none;
            color: #ff5c5c;
            cursor: pointer;
            font-size: 16px;
            align-self: center;
        }
        .user-info {
            display: flex;
            align-items: center;
            gap: 10px;
            margin-bottom: 20px;
        }
        .user-info input {
            padding: 10px;
            border-radius: 5px;
            border: 1px solid #ccc;
        }
        .user-info img {
            width: 50px;
            height: 50px;
            border-radius: 50%;
        }
        
        footer {
            background-color: #6c4f3d;
            color: #ffffff;
            text-align: center;
            position: bottom;
            width: 100%;
        }
    </style>
</head>
<body>
    <header>
        <h1>我們這一家</h1>
    </header>

    <nav>
        <a href="index.html">家庭成員</a>
        <a href="member.html">我們家的足跡</a>
        <a href="talk.html">想說的話</a>
    </nav>


    <div class="container">
        
        <div class="user-info">
            <input type="text" id="usernameInput" placeholder="您ㄟ大名(小名也可以)">  
            <input type="file" id="imageInput" accept="image/*">  
            <img id="userAvatar" src="https://via.placeholder.com/50" alt="User Avatar">  
        </div>

        <div class="input-area">
            <textarea id="messageInput" placeholder="請留下您任何一段話(想對自己或是家人)"></textarea>
            <button onclick="addMessage()">➡</button>
        </div>

        <div id="messages">
        </div>
    </div>

    <script>

        document.addEventListener('DOMContentLoaded', loadMessages);


        function addMessage() {
            const username = document.getElementById('usernameInput').value.trim() || "噓"; 
            const input = document.getElementById('messageInput');
            const avatar = document.getElementById('userAvatar').src;  

            if (input.value.trim() === '') {
                alert('沒有輸入還想按我！');
                return;
            }


            const now = new Date();
            const timestamp = `${now.getFullYear()}年${now.getMonth() + 1}月${now.getDate()}日 ${now.getHours()}點${now.getMinutes()}分`;


            const message = {
                username: username,
                content: input.value,
                time: timestamp,
                avatar: avatar  
            };


            const messages = getMessages();
            messages.push(message);
            saveMessages(messages);


            renderMessage(message);

            input.value = '';
        }

        function loadMessages() {
            const messages = getMessages();
            messages.forEach(message => renderMessage(message));
        }


        function renderMessage(message) {
            const messagesDiv = document.getElementById('messages');


            const messageDiv = document.createElement('div');
            messageDiv.className = 'message';

            const avatar = document.createElement('img');
            avatar.src = message.avatar;  
            avatar.alt = "User Avatar";


            const contentDiv = document.createElement('div');
            contentDiv.className = 'message-content';

            const username = document.createElement('h4');
            username.textContent = message.username;

            const messageText = document.createElement('p');
            messageText.textContent = message.content;

            const timestamp = document.createElement('div');
            timestamp.className = 'timestamp';
            timestamp.textContent = message.time;

            const deleteButton = document.createElement('button');
            deleteButton.className = 'delete-btn';
            deleteButton.textContent = '✖';
            deleteButton.onclick = function () {
                deleteMessage(message);
                messagesDiv.removeChild(messageDiv);
            };

            contentDiv.appendChild(username);
            contentDiv.appendChild(messageText);
            contentDiv.appendChild(timestamp);

            messageDiv.appendChild(avatar);
            messageDiv.appendChild(contentDiv);
            messageDiv.appendChild(deleteButton);


            messagesDiv.prepend(messageDiv);
        }


        function deleteMessage(targetMessage) {
            const messages = getMessages();
            const updatedMessages = messages.filter(
                message => message.content !== targetMessage.content || message.time !== targetMessage.time
            );
            saveMessages(updatedMessages);
        }


        function getMessages() {
            const messages = localStorage.getItem('messages');
            return messages ? JSON.parse(messages) : [];
        }


        function saveMessages(messages) {
            localStorage.setItem('messages', JSON.stringify(messages));
        }
    </script>

    <footer class="bg-body-tertiary text-center text-lg-start">
        <div class="text-center p-3" >
          © 2024 
          <a class="text-body" href="https://www.instagram.com/shan10_13/" >shan</a>
        </div>
      </footer>
</body>
</html>
